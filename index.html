<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="栩栩如生">
<meta property="og:url" content="https://caitianxu.github.io/index.html">
<meta property="og:site_name" content="栩栩如生">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="栩栩如生">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://caitianxu.github.io/"/>





  <title>栩栩如生</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">栩栩如生</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">专心致志敲代码、说得太多都是废话</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://caitianxu.github.io/2018/05/23/25/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Henry.Cai">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="栩栩如生">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/25/" itemprop="url">使用angularJs+webpack搭建兼容IE8单页应用工程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T17:31:32+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AngularJS基础规范及知识点/" itemprop="url" rel="index">
                    <span itemprop="name">AngularJS基础规范及知识点</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文从<code>零基础</code>讲解使用webpack+angularJs搭建一个兼容IE8的工程架构。以及简易的项目架构。<br>webpack模版页配置，公共文件抽离、公共样式独立输出、html/css压缩等等基础功能。<br>项目中结合todoList的案例讲述路由，双向数据绑定，页面间值传递，工厂、自定义指令、脏检查、依赖注入等常用功能。<br>(部分细节比较基础， 有经验的小伙伴可以自行跳过)</p>
<p>在搭建之前请正确安装nodejs保证npm4.0以上即可.</p>
<h3 id="新建项目文件夹"><a href="#新建项目文件夹" class="headerlink" title="新建项目文件夹"></a>新建项目文件夹</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir myApp</span><br><span class="line">cd myApp</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### 初始化工厂配置文件</span><br><span class="line">```c</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure>
<p>这里初始化一个<code>package.json</code>文件, 需要的属性都可以直接为空，Enter跳过。<br>注意：author 、repository 、description 最好都填一下。 不然对于有些强迫症编译时控制台一直报警告会觉得难受…..</p>
<h3 id="webpack安装"><a href="#webpack安装" class="headerlink" title="webpack安装"></a>webpack安装</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D webpack@<span class="number">3.10</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>
<p>这里要注意一点， 本项目配置中由于一些特殊的插件使用。 请指定<a href="mailto:`webpack@3.10.0" target="_blank" rel="noopener">`webpack@3.10.0</a><code>进行安装。不然@#$%^&amp;*()</code>真的会报错!`</p>
<h3 id="webpack配置"><a href="#webpack配置" class="headerlink" title="webpack配置"></a>webpack配置</h3><p>在根目录下新建一个配置文件<code>webpack.config.js</code><br>以下为部分基础代码：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">  target: <span class="string">'web'</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: path.resolve(__dirname, <span class="string">'./src/main.js'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].[hash:5].js'</span>,</span><br><span class="line">    path: path.join(__dirname, <span class="string">'./dist'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// plugins: [],</span></span><br><span class="line">  <span class="comment">// module: &#123;&#125;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure></p>
<p>注意：<br>1、尽量使用path进行路径处理， 避免不同系统下路径错误。<br>2、创建一个webpack对象，这个后面会用到<br>3、webpack中5个最主要的配置属性：<br>  1&gt; target 也就是指你最终的程序是运行在什么环境上，常用的‘web’、‘node’。默认就是‘web’<br>  2&gt; entry 程序入口，指定你程序执行的入口文件。可以配置多个。这里的工程比较简单一个就够了。<br>     这里的app属性是一个不定动态值， 这个值就是最终决定你文件输出的name。这个key后面会讲解使用场景。我们也可以使用main、index等等看各自喜好。<br>     path.join  path.resolve 其实两个方法都差不多，一个是拼接一个是组合。 __dirname 是内部的一个成员变量， 指向的是工程的物理文件路径。<br>  3&gt; output 顾名思义就是输出，常用属性：<br>     filename： 主文件生成名称，这里使用的name就是上面讲到的app<br>     hash：是我们每次编译都会动态生成的一个不定值， 有的使用chankhash。默认会比较长10几位吧。 :5表示只截取5个长度使用。<br>     path: 就是整个工程编译结果的输出目录了，这里命名为dist。 每次编译所有编译结果会存放到dist文件夹中。dist不存在会自动创建。<br>  4&gt; plugins 一些第三方的插件功能使用需要将代码放在plugin中。<br>  5&gt; module 一些插件或规则配置会存放在module中。 大多时候是跟plugin一起配合使用。<br>4、以上我们就创建一个config的配置对象。 将整个对象赋值给 module.exports. 整个工程到目前为止其实基础配置已经完成，并且可以使用了。<br>5、文件创建<br>   上面使用到了src/main.js 但目前项目中不存在， 创建它， 随便写点内容。</p>
<h3 id="package-json中配置命令-npm-run-build"><a href="#package-json中配置命令-npm-run-build" class="headerlink" title="package.json中配置命令  npm run build"></a>package.json中配置命令  npm run build</h3><p>指令配置在package.json文件中的额scripts属性中完成。<br>默认生成的test命令，可以删除。对我们目前项目来讲没什么用处。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "build": "webpack --config webpack.config.js",</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>命令申明了运行build时 指向了我们刚刚创建的webpack.config.js文件<br>额外介绍下 devDependencies 和 dependencies的属性。<br>devDependencies是我们整个工程在开发/编译过程中需要用到的组件，<br>dependencies但是整个工程在正式运行时仍然要运行的组件。（整个工程我们使用静态引用不会使用到）</p>
<h3 id="首次编译"><a href="#首次编译" class="headerlink" title="首次编译"></a>首次编译</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>
<p>项目中就生成了一个dist文件夹， 这里就是整个项目以后编译存放结果的地方。</p>
<p>以上步骤写得太细，太耗时间，后面就单文件整个讲述了。</p>
<h3 id="完整的package-json文件"><a href="#完整的package-json文件" class="headerlink" title="完整的package.json文件"></a>完整的package.json文件</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"webpack-angular-ie8"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"this is webpack-angular-ie8 prj demo"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"clean"</span>: <span class="string">"rimraf dist"</span>,</span><br><span class="line">    <span class="attr">"build:client"</span>: <span class="string">"cross-env NODETYPE=1 webpack --config webpack.config.js"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"npm run clean &amp;&amp; npm run build:client"</span>,</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"cross-env NODETYPE=0 webpack-dev-server --config webpack.config.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"Henry.Cai"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"repository"</span>: &#123;</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"git@github.com:caitianxu/angular-ie8.git"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"copy-webpack-plugin"</span>: <span class="string">"^4.5.1"</span>,</span><br><span class="line">    <span class="attr">"cross-env"</span>: <span class="string">"^5.1.5"</span>,</span><br><span class="line">    <span class="attr">"css-loader"</span>: <span class="string">"^0.28.11"</span>,</span><br><span class="line">    <span class="attr">"extract-text-webpack-plugin"</span>: <span class="string">"^3.0.2"</span>,</span><br><span class="line">    <span class="attr">"html-webpack-plugin"</span>: <span class="string">"^3.2.0"</span>,</span><br><span class="line">    <span class="attr">"rimraf"</span>: <span class="string">"^2.6.2"</span>,</span><br><span class="line">    <span class="attr">"style-loader"</span>: <span class="string">"^0.21.0"</span>,</span><br><span class="line">    <span class="attr">"webpack"</span>: <span class="string">"^3.10.0"</span>,</span><br><span class="line">    <span class="attr">"webpack-dev-server"</span>: <span class="string">"^2.11.2"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>命令讲解：</p>
<h4 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h4><p>每次编译，dist目录中都会存放当前生成内容和上次编译生成内容。 手动删除太麻烦， 留着又没什么用处。<br>所以我们这里引入一个<code>rimraf</code> 插件， 帮助我们删除原来的文件内容。</p>
<h4 id="build-client"><a href="#build-client" class="headerlink" title="build:client"></a>build:client</h4><p>为了方便新建一个build:client命令， 存放原本的编译文件指向。</p>
<h4 id="build"><a href="#build" class="headerlink" title="build"></a>build</h4><p>新建一个build命令，将clean和buil:client两个命令串联起来， 不用执行时每个单独去敲。<br><code>cross-env NODE_ENV=production</code><br>这是一段新加入的代码， 作用是方便我们在编译时去指定我们的代码运行环境， 毕竟我们代码不可能永远跑开发环境 还需要上线不是~<br>所以这里引入了<code>cross-env</code>插件， 他可以帮助你在命令时就指定一个全局变量，在nodejs代码执行时去使用他。</p>
<h4 id="dev"><a href="#dev" class="headerlink" title="dev"></a>dev</h4><p>这是一个在开发过程中一直使用的命令，他让我们的代码能够在编码过程中在浏览器中运行起来。并且还不需要一个劲的F5，当然他的作用不仅仅这一点 <del>~0.0</del>~。<br>这个命令中我们使用到一个<code>webpack-dev-server</code>插件，他的作用我们在后面config中讲解。注意他的版本必须是<code>2.11.2</code>这里整个工程中第二个需要制定版本号的插件。</p>
<p>至于devDependencies其他插件， 都是后面需要用到的。 具体功能在config中会详细讲解。</p>
<h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">var</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">var</span> isDev = process.env.NODETYPE === <span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">var</span> ExtractPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">  target: <span class="string">'web'</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: path.resolve(__dirname, <span class="string">'./src/main.js'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].[hash:5].js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'./dist'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">//这里创建了一个全局变量， 可以在项目代码中使用 进行区分项目环境</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">'PRODUCTION'</span>: !isDev</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">//使用html模板</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      <span class="comment">//指定了项目默认使用的html模版</span></span><br><span class="line">      template: <span class="string">'./src/main.html'</span>,</span><br><span class="line">      minify: &#123; </span><br><span class="line">        <span class="comment">//删除注释 空白间隔 换行符 minify还有其他属性， 需要可以查看api</span></span><br><span class="line">        removeComments: <span class="literal">true</span>,  </span><br><span class="line">        collapseWhitespace: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">//复制静态资源 在项目中我们有很多静态资源是不需要编译的， 可以自己在代码中使用</span></span><br><span class="line">    <span class="comment">//所以这里引用了copy-webpack-plugin 将需要的内容在编译时直接拷贝的生成目录</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([&#123;</span><br><span class="line">      <span class="keyword">from</span>: <span class="string">'src/lib'</span>,</span><br><span class="line">      to: <span class="string">'lib'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="keyword">from</span>: <span class="string">'src/images'</span>,</span><br><span class="line">      to: <span class="string">'images'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      <span class="keyword">from</span>: <span class="string">'src/views'</span>,</span><br><span class="line">      to: <span class="string">'views'</span></span><br><span class="line">    &#125;]),</span><br><span class="line">    <span class="comment">//单独输出公共的css</span></span><br><span class="line">    <span class="keyword">new</span> ExtractPlugin(<span class="string">"[name].[hash:5].css"</span>),</span><br><span class="line">    <span class="comment">//单独输出webpack配置文件</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(<span class="string">"vendor"</span>)</span><br><span class="line">  ],</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">      use: ExtractPlugin.extract(&#123;</span><br><span class="line">        fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">        use: [&#123;</span><br><span class="line">          loader: <span class="string">"css-loader"</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            minimize: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//在开发环境时， 需要在浏览器中运行、调试 所以这里做判断只在开发环境下“npm run dev” 下配置端口和host</span></span><br><span class="line"><span class="comment">//因为工程本身解构缘故，不太适合热更新。 所以这里没有配置hot。</span></span><br><span class="line"><span class="keyword">if</span> (isDev) &#123;</span><br><span class="line">  config.devServer = &#123;</span><br><span class="line">    port: <span class="number">8888</span>,</span><br><span class="line">    host: <span class="string">'0.0.0.0'</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = config;</span><br></pre></td></tr></table></figure>
<p>到目前为止， 我们的工程架构算已经搭建完成了。下面开始项目架构的内容。</p>
<h3 id="main-html-模版页"><a href="#main-html-模版页" class="headerlink" title="main.html 模版页"></a>main.html 模版页</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge,chrome=1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Access-Control-Allow-Origin"</span> <span class="attr">content</span>=<span class="string">"*"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>webpack-angular-ie8<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"./images/favicon.ico"</span> <span class="attr">rel</span>=<span class="string">"shortcut icon"</span> <span class="attr">type</span>=<span class="string">"image/x-icon"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/angular-ui-router.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/ocLazyLoad.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--[if lte IE 8]&gt;</span></span><br><span class="line"><span class="comment">    &lt;script&gt;</span></span><br><span class="line"><span class="comment">      window.noop=function()&#123;&#125;;window.console=window.console||&#123;log:window.noop,de<span class="doctag">bug:</span>window.noop,info:window.noop,warn:window.noop,exception:window.noop,assert:window.noop,dir:window.noop,dirxml:window.noop,trace:window.noop,group:window.noop,groupCollapsed:window.noop,groupEnd:window.noop,profile:window.noop,profileEnd:window.noop,count:window.noop,clear:window.noop,time:window.noop,timeEnd:window.noop,timeStamp:window.noop,table:window.noop,error:window.noop&#125;;</span></span><br><span class="line"><span class="comment">    &lt;/script&gt;</span></span><br><span class="line"><span class="comment">  &lt;![endif]--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="comment">    &lt;script src="./lib/html5.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">    &lt;script src="./lib/css3-mediaqueries.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">  &lt;![endif]--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">"ng-app"</span> <span class="attr">ng-app</span>=<span class="string">"app"</span> <span class="attr">ng-controller</span>=<span class="string">"mainController"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ui-view parent-main-page"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里我们就不通过 require 或者 import 去加载 angular， 因为这种默认在ie环境下会报一些错误， 修改起来也比较麻烦。<br>另外一个编译之后的代码也不支持ie8 至少当前这个webpack版本是跑不起来的。 低版本的不太清楚， 有兴趣的可以去试试。<br>另外这里使用到了  angular-ui-router  ocLazyLoad 两个常用插件<br>angular本身也有提供angular-router 但是使用起来没有ui-rotuer方便 功能也不够强大。<br>ocLazyLoad是提供一个按需加载模块的功能。 这两个插件的使用会在项目架构中具体讲到。</p>
<!--[if lte IE 8]> .. <![endif]-->
<p>在ie低版本 console 等方法是不支持的， 而我们编码过程中不太可能避免使用他。 并且哪怕自己编码不使用，你说使用的插件也有可能在使用。<br>所以在项目运行前期， 我们进行判断去申明配置。</p>
<p>html5.js css3-mediaqueries.js 可以在低版本IE中具有一部分html5 css3的功能使用。 具体的可以在官方api中查看，这里我们不去将html5，css3只是<br>在工程架构中引进来即可。</p>
<p><code>id=&quot;ng-app&quot;</code>  这个属性在低版本IE中尤为重要， 因为他不识别 ng-app指令 配置这个id后 方便angular寻找<br><code>ng-app=&quot;app&quot;</code> 这里就什么一个app的模块， app的创建会在下面讲到。 大致意思就是你所创建的app的代码就作用域在当前这个<code>body</code>标签之内，<br>并且也只在这个作用域有效。<br><code>ng-controller</code> 是angular的一个主要指令， 代表一个控制器， 一个模块下可以有很多控制器， 每个控制器的代码只会在当前ng-controller内部有效<br>至于ng-app 与 ng-controller之间的关系我可以用一个图来描述。</p>
<p><img src="/2018/05/23/25/ay5h.png" alt="">  </p>
<p><code>ui-view</code>这个代表的是angular路由的标识，这个路由其实也是一个指令， angular的指令表现形式有4种， 后面自定义指令时会具体讲解。<br>很多人看到放在css里面不就是一个样式名吗？ 怎么会是这个指令？那么我们如果这样写大家就应该更能理解：</p>
<p><ui-view></ui-view> 或者 <div ui-view=""></div> 这都是常用写法。不过为了兼容IE我们还是尽量使用 class名的写法。<br>指令还有另外一种写法  <!-- ui-view --> 注解方式。</p>
<p>路由创建后，这个DOM标签就是我们业务模块的内容容器了。</p>
<h3 id="项目目录结构"><a href="#项目目录结构" class="headerlink" title="项目目录结构"></a>项目目录结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">src   主目录</span><br><span class="line">    - iamges 静态资源文件</span><br><span class="line">    - js 核心模块</span><br><span class="line">    - json 模拟接口文件</span><br><span class="line">    - lib 静态引用的框架和组件</span><br><span class="line">    - views 业务模块</span><br><span class="line">    - main.js webpack工程入口文件</span><br><span class="line">    - main.html html模版文件</span><br><span class="line">    </span><br><span class="line">css</span><br><span class="line">    -public.css 公共样式文件</span><br><span class="line">    - reset.css 网页重置样式文件</span><br><span class="line"></span><br><span class="line">dist 生产内容</span><br><span class="line"></span><br><span class="line">webpack.config.js  工程配置文件</span><br></pre></td></tr></table></figure>
<h3 id="main-js"><a href="#main-js" class="headerlink" title="main.js"></a>main.js</h3><p>在这个项目里， 我们的主入口文件就不些太多的功能代码， 只将项目的主要使用文件做一个统一引用就行了<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./css/reset.css'</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'.//css/public.css'</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./js/app.js'</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./js/app_directive.js'</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./js/app_servers.js'</span>)</span><br></pre></td></tr></table></figure></p>
<p>css的使用就不过多讲解， 我们看js的引用</p>
<p>app.js是项目主程序文件， 里面创建了我们的app module， 和我们主控制器 mainController 以及一些路由配置；<br>app_directive.js 是项目创建自定义指令的文件。（这里讲的自定义指令其实就是自定义控件）<br>app_servers.js 创建了项目http服务， 存放一些公共接口和get post接口公共处理。</p>
<h3 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.myApp = angular.module(<span class="string">"app"</span>, [<span class="string">"myDirectives"</span>, <span class="string">"myServices"</span>, <span class="string">"oc.lazyLoad"</span>, <span class="string">"ui.router"</span>]);</span><br><span class="line">myApp.run([<span class="string">"$rootScope"</span>, <span class="string">"services"</span>, <span class="string">"$sce"</span>, <span class="string">"pop"</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">$rootScope, services, $sce, pop</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'run'</span>)</span><br><span class="line">    <span class="comment">//自定义组件</span></span><br><span class="line">    $rootScope.pop = pop;</span><br><span class="line">    <span class="comment">//全局公共变量</span></span><br><span class="line">    $rootScope.isPro = PRODUCTION;</span><br><span class="line">    $rootScope.ctxPath = PRODUCTION ? <span class="string">''</span> : <span class="string">''</span>;</span><br><span class="line">    $rootScope.token = <span class="literal">null</span>;</span><br><span class="line">    $rootScope.uid = <span class="literal">null</span>;</span><br><span class="line">    $rootScope.LoginUser = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//开始加载新页面</span></span><br><span class="line">    $rootScope.$on(<span class="string">"$stateChangeStart"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event, toState, fromState, fromParams</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'load success:'</span> + toState.name)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//页面加载成功</span></span><br><span class="line">    $rootScope.$on(<span class="string">"$stateChangeSuccess"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event, toState, toParams, fromState, fromParams</span>) </span>&#123;&#125;);</span><br><span class="line">    <span class="comment">//页面加载失败</span></span><br><span class="line">    $rootScope.$on(<span class="string">"$stateChangeError"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event, toState, toParams, fromState, fromParams, error</span>) </span>&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//主控制器</span></span><br><span class="line">myApp.controller(<span class="string">"mainController"</span>, [</span><br><span class="line">  <span class="string">"$rootScope"</span>,</span><br><span class="line">  <span class="string">"$scope"</span>,</span><br><span class="line">  <span class="string">"services"</span>,</span><br><span class="line">  <span class="string">"$sce"</span>,</span><br><span class="line">  <span class="string">"$state"</span>,</span><br><span class="line">  <span class="string">"$timeout"</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">$rootScope, $scope, services, $sce, $state, $timeout</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'main'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//路由配置</span></span><br><span class="line">myApp.config(<span class="function"><span class="keyword">function</span> (<span class="params">$stateProvider, $urlRouterProvider, $controllerProvider, $compileProvider, $filterProvider, $provide</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'config'</span>)</span><br><span class="line">  myApp.controller = $controllerProvider.register;</span><br><span class="line">  myApp.directive = $compileProvider.directive;</span><br><span class="line">  myApp.filter = $filterProvider.register;</span><br><span class="line">  myApp.factory = $provide.factory;</span><br><span class="line">  myApp.service = $provide.service;</span><br><span class="line">  myApp.constant = $provide.constant;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//默认页面</span></span><br><span class="line">  $urlRouterProvider.when(<span class="string">""</span>, <span class="string">"/index"</span>);</span><br><span class="line">  <span class="comment">//不规则页面</span></span><br><span class="line">  $urlRouterProvider.otherwise(<span class="string">"/error"</span>);</span><br><span class="line">  <span class="comment">//首页</span></span><br><span class="line">  $stateProvider.state(<span class="string">"index"</span>, &#123;</span><br><span class="line">    url: <span class="string">"/index"</span>,</span><br><span class="line">    templateUrl: <span class="string">"./views/index/page.html"</span>,</span><br><span class="line">    controller: <span class="string">"indexController"</span>,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      loadMyCtrl: [<span class="string">"$ocLazyLoad"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$ocLazyLoad</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $ocLazyLoad.load([</span><br><span class="line">          <span class="string">"./views/index/page.css"</span>,</span><br><span class="line">          <span class="string">"./views/index/page.js"</span></span><br><span class="line">        ])</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//详情页</span></span><br><span class="line">  $stateProvider.state(<span class="string">"info"</span>, &#123;</span><br><span class="line">    url: <span class="string">"/info/:id&amp;:name"</span>,</span><br><span class="line">    templateUrl: <span class="string">"./views/info/page.html"</span>,</span><br><span class="line">    controller: <span class="string">"infoController"</span>,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      loadMyCtrl: [<span class="string">"$ocLazyLoad"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$ocLazyLoad</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $ocLazyLoad.load([</span><br><span class="line">          <span class="string">"./views/info/page.css"</span>,</span><br><span class="line">          <span class="string">"./views/info/page.js"</span></span><br><span class="line">        ])</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//错误页</span></span><br><span class="line">  $stateProvider.state(<span class="string">"error"</span>, &#123;</span><br><span class="line">    url: <span class="string">"/error"</span>,</span><br><span class="line">    templateUrl: <span class="string">"./views/error/page.html"</span>,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      loadMyCtrl: [<span class="string">"$ocLazyLoad"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$ocLazyLoad</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $ocLazyLoad.load([<span class="string">"./views/error/page.css"</span>])</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="app-directive-js"><a href="#app-directive-js" class="headerlink" title="app_directive.js"></a>app_directive.js</h3><p>为了方便理解，这里我特意写了 两个自定义指令，<br>信息提示框  alert  confirm<br>一个内容弹出层 dialog<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'myDirectives'</span>, [])</span><br><span class="line">  .directive(<span class="string">'pop'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      restrict: <span class="string">'ECAM'</span>,</span><br><span class="line">      template: <span class="string">'&lt;div class="ng-pop" ng-if="pop.visible"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-pop-bg"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-pop-content"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-pop-title"&gt;&lt;span ng-bind="pop.title"&gt;&lt;/span&gt;&lt;label class="ng-pop-close iconfont icon-close" ng-click="pop.close()"&gt;&lt;/label&gt;&lt;/div&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-pop-text" ng-bind="pop.message"&gt;&lt;/div&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-pop-action"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;button class="btn" ng-click="pop.confirm_default()"&gt;确定&lt;/button&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;button class="btn btn-default" ng-if="pop.showCancel" ng-click="pop.cancel_default()"&gt;取消&lt;/button&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'</span>,</span><br><span class="line">      replace: <span class="literal">true</span>,</span><br><span class="line">      link: <span class="function"><span class="keyword">function</span> (<span class="params">scope, element, attr</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'link'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .provider(<span class="string">'pop'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(<span class="built_in">document</span>.createElement(<span class="string">'pop'</span>));</span><br><span class="line">    <span class="keyword">this</span>.$get = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        title: <span class="string">"提示"</span>,</span><br><span class="line">        message: <span class="string">"消息内容"</span>,</span><br><span class="line">        visible: <span class="literal">false</span>,</span><br><span class="line">        showCancel: <span class="literal">false</span>,</span><br><span class="line">        alert: <span class="function"><span class="keyword">function</span> (<span class="params">title, message, confirm_back</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.title = title;</span><br><span class="line">          <span class="keyword">this</span>.message = message;</span><br><span class="line">          <span class="keyword">this</span>.confirm_back = confirm_back;</span><br><span class="line">          <span class="keyword">this</span>.cancel_back = <span class="literal">null</span>;</span><br><span class="line">          <span class="keyword">this</span>.showCancel = <span class="literal">false</span>;</span><br><span class="line">          <span class="keyword">this</span>.visible = <span class="literal">true</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        confirm: <span class="function"><span class="keyword">function</span> (<span class="params">title, message, confirm_back, cancel_back</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.title = title;</span><br><span class="line">          <span class="keyword">this</span>.message = message;</span><br><span class="line">          <span class="keyword">this</span>.confirm_back = confirm_back;</span><br><span class="line">          <span class="keyword">this</span>.cancel_back = cancel_back;</span><br><span class="line">          <span class="keyword">this</span>.showCancel = <span class="literal">true</span>;</span><br><span class="line">          <span class="keyword">this</span>.visible = <span class="literal">true</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        close: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.visible = <span class="literal">false</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        confirm_back: <span class="literal">null</span>,</span><br><span class="line">        cancel_back: <span class="literal">null</span>,</span><br><span class="line">        confirm_default: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.close();</span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">this</span>.confirm_back) &#123;</span><br><span class="line">            <span class="keyword">this</span>.confirm_back();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        cancel_default: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.close();</span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">this</span>.cancel_back) &#123;</span><br><span class="line">            <span class="keyword">this</span>.cancel_back();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .directive(<span class="string">'dialog'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      restrict: <span class="string">'ECAM'</span>,</span><br><span class="line">      template: <span class="string">'&lt;div class="ng-dialog" ng-show="visible" ng-style="body"&gt;&lt;div class="ng-dialog-bg" ng-class="&#123;\'ng-dialog-bg-color\': !pmp.hideshade&#125;"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-dialog-plan" ng-style="content"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-dialog-title" ng-if="!pmp.hidetitle"&gt;&lt;label ng-bind="pmp.title"&gt;&lt;/label&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;ul&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;li class="top-action-min" ng-click="minmax()"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;span class="iconfont icon-minus" ng-hide="pmp.min"&gt;&lt;/span&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;span class="iconfont icon-block" ng-show="pmp.min"&gt;&lt;/span&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/li&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;li class="top-action-min" ng-click="maxmin()" ng-hide="pmp.min"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;span class="iconfont icon-arrawsalt" ng-show="!pmp.max"&gt;&lt;/span&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;span class="iconfont icon-shrink" ng-show="pmp.max"&gt;&lt;/span&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/li&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;li class="top-action-min" ng-click="closeDialog()"&gt;&lt;span class="iconfont icon-close"&gt;&lt;/span&gt;&lt;/li&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/ul&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/div&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-dialog-content" ng-style="&#123;\'height\': pmp.contentHeight + \'px\'&#125;" ng-transclude&gt;&lt;/div&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;div class="ng-dialog-action" ng-if="!pmp.hideaction"&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;button class="btn" ng-bind="pmp.confirmText"&gt;&lt;/button&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;button class="btn btn-default" ng-bind="pmp.cancelText"&gt;&lt;/button&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/div&gt;'</span> +</span><br><span class="line">        <span class="string">'&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'</span>,</span><br><span class="line">      replace: <span class="literal">true</span>,</span><br><span class="line">      transclude: <span class="literal">true</span>,</span><br><span class="line">      scope: &#123;</span><br><span class="line">        visible: <span class="string">'=visible'</span>, <span class="comment">//是否显示</span></span><br><span class="line">        cancel: <span class="string">'&amp;cancel'</span>, <span class="comment">//取消回调</span></span><br><span class="line">        confirm: <span class="string">'&amp;confirm'</span>, <span class="comment">//确认回调</span></span><br><span class="line">      &#125;,</span><br><span class="line">      link: <span class="function"><span class="keyword">function</span> (<span class="params">scope, element, attr</span>) </span>&#123;</span><br><span class="line">        scope.pmp = &#123;</span><br><span class="line">          allWidth: <span class="built_in">document</span>.body.clientWidth,</span><br><span class="line">          allHeight: <span class="built_in">document</span>.body.clientHeight,</span><br><span class="line">          width: attr.width || <span class="number">520</span>,</span><br><span class="line">          height: attr.height || <span class="number">200</span>,</span><br><span class="line">          contentHeight: (attr.height || <span class="number">200</span>) - <span class="number">100</span>,</span><br><span class="line">          top: <span class="number">0</span>,</span><br><span class="line">          left: <span class="number">0</span>,</span><br><span class="line">          title: attr.title || <span class="string">''</span>,</span><br><span class="line">          drag: attr.drag === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>, <span class="comment">//是否可以拖动</span></span><br><span class="line">          hidetitle: attr.hidetitle === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>, <span class="comment">//隐藏标题栏</span></span><br><span class="line">          hideaction: attr.hideaction === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>, <span class="comment">//隐藏操作栏</span></span><br><span class="line">          hideshade: attr.hideshade === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>, <span class="comment">//隐藏遮罩层</span></span><br><span class="line">          confirmText: attr.confirmtext || <span class="string">'确定'</span>,</span><br><span class="line">          cancelText: attr.canceltext || <span class="string">'取消'</span>,</span><br><span class="line">          max: attr.max === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>, <span class="comment">//是否全屏化窗口</span></span><br><span class="line">          min: attr.min === <span class="string">'true'</span> ? <span class="literal">true</span> : <span class="literal">false</span>, <span class="comment">//是否最小化窗口</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//外层样式</span></span><br><span class="line">        scope.body = &#123;</span><br><span class="line">          width: <span class="string">'100%'</span>,</span><br><span class="line">          height: <span class="string">'100%'</span>,</span><br><span class="line">          top: <span class="number">0</span>,</span><br><span class="line">          left: <span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//内容样式</span></span><br><span class="line">        scope.content = &#123;</span><br><span class="line">          width: <span class="string">'100%'</span>,</span><br><span class="line">          height: <span class="string">'100%'</span>,</span><br><span class="line">          top: <span class="number">0</span>,</span><br><span class="line">          left: <span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//取消事件</span></span><br><span class="line">        scope.cancelEvent = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          scope.visible = <span class="literal">false</span>;</span><br><span class="line">          scope.pmp.min = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//确认事件</span></span><br><span class="line">        scope.confirmEvent = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          scope.visible = <span class="literal">false</span>;</span><br><span class="line">          scope.pmp.min = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//全屏化切换</span></span><br><span class="line">        scope.maxmin = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          scope.pmp.max = !scope.pmp.max;</span><br><span class="line">          scope.pmp.min = <span class="literal">false</span>;</span><br><span class="line">          scope.changeSize();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//最小化</span></span><br><span class="line">        scope.minmax = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          scope.pmp.min = !scope.pmp.min;</span><br><span class="line">          scope.changeSize();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//重新计算定位</span></span><br><span class="line">        scope.changeSize = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          $(<span class="string">'html'</span>).css(<span class="string">"overflow"</span>, <span class="string">"hidden"</span>);</span><br><span class="line">          scope.pmp.allWidth = <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line">          scope.pmp.allHeight = <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">          <span class="keyword">if</span> (scope.pmp.max) &#123;</span><br><span class="line">            scope.pmp.width = scope.pmp.allWidth;</span><br><span class="line">            scope.pmp.height = scope.pmp.allHeight;</span><br><span class="line">            scope.pmp.left = <span class="number">0</span>;</span><br><span class="line">            scope.pmp.top = <span class="number">0</span>;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $(<span class="string">'html'</span>).css(<span class="string">"overflow"</span>, <span class="string">""</span>);</span><br><span class="line">            scope.pmp.width = attr.width || <span class="number">520</span>;</span><br><span class="line">            scope.pmp.height = attr.height || <span class="number">200</span>;</span><br><span class="line">            scope.pmp.left = (scope.pmp.allWidth - scope.pmp.width) / <span class="number">2</span>;</span><br><span class="line">            scope.pmp.top = (scope.pmp.allHeight - scope.pmp.height) / <span class="number">2</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          scope.pmp.contentHeight = scope.pmp.height - <span class="number">100</span>;</span><br><span class="line">          <span class="keyword">if</span> (scope.pmp.hidetitle) scope.pmp.contentHeight += <span class="number">45</span>;</span><br><span class="line">          <span class="keyword">if</span> (scope.pmp.hideaction) scope.pmp.contentHeight += <span class="number">55</span>;</span><br><span class="line">          <span class="comment">//没有遮罩</span></span><br><span class="line">          <span class="keyword">if</span> (scope.pmp.hideshade) &#123;</span><br><span class="line">            scope.body = &#123;</span><br><span class="line">              width: scope.pmp.width + <span class="string">'px'</span>,</span><br><span class="line">              height: scope.pmp.height + <span class="string">'px'</span>,</span><br><span class="line">              top: scope.pmp.top + <span class="string">'px'</span>,</span><br><span class="line">              left: scope.pmp.left + <span class="string">'px'</span>,</span><br><span class="line">            &#125;</span><br><span class="line">            scope.content = &#123;</span><br><span class="line">              width: scope.pmp.width + <span class="string">'px'</span>,</span><br><span class="line">              height: scope.pmp.height + <span class="string">'px'</span>,</span><br><span class="line">              left: <span class="number">0</span>,</span><br><span class="line">              top: <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            scope.body = &#123;</span><br><span class="line">              width: <span class="string">'100%'</span>,</span><br><span class="line">              height: <span class="string">'100%'</span>,</span><br><span class="line">              top: <span class="number">0</span>,</span><br><span class="line">              left: <span class="number">0</span>,</span><br><span class="line">            &#125;</span><br><span class="line">            scope.content = &#123;</span><br><span class="line">              width: scope.pmp.width + <span class="string">'px'</span>,</span><br><span class="line">              height: scope.pmp.height + <span class="string">'px'</span>,</span><br><span class="line">              top: scope.pmp.top + <span class="string">'px'</span>,</span><br><span class="line">              left: scope.pmp.left + <span class="string">'px'</span>,</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">//最小化</span></span><br><span class="line">          <span class="keyword">if</span> (scope.pmp.min) &#123;</span><br><span class="line">            scope.body = &#123;</span><br><span class="line">              width: <span class="string">'280px'</span>,</span><br><span class="line">              height: <span class="string">'45px'</span>,</span><br><span class="line">              bottom: <span class="number">0</span>,</span><br><span class="line">              left: <span class="number">0</span>,</span><br><span class="line">              top: <span class="string">'auto'</span></span><br><span class="line">            &#125;</span><br><span class="line">            scope.content = &#123;</span><br><span class="line">              width: <span class="string">'100%'</span>,</span><br><span class="line">              height: <span class="number">0</span>,</span><br><span class="line">              top: <span class="number">0</span>,</span><br><span class="line">              left: <span class="number">0</span>,</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭</span></span><br><span class="line">        scope.closeDialog = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          scope.visible = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//初始化状态</span></span><br><span class="line">        scope.changeSize();</span><br><span class="line">        <span class="comment">//窗口监控</span></span><br><span class="line">        jQuery(<span class="built_in">window</span>).resize(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (scope.visible) &#123;</span><br><span class="line">            scope.$apply(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">              scope.changeSize();</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//监控显示</span></span><br><span class="line">        scope.$watch(<span class="string">'visible'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (n) &#123;</span><br><span class="line">            scope.pmp.min = <span class="literal">false</span>;</span><br><span class="line">            scope.changeSize()</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="app-servers-js"><a href="#app-servers-js" class="headerlink" title="app_servers.js"></a>app_servers.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">"myServices"</span>, []).factory(<span class="string">'services'</span>, [<span class="string">'$http'</span>, <span class="string">'$rootScope'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$http, $rootScope</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 服务端请求模板</span></span><br><span class="line"><span class="comment">   * @param url 服务端请求url</span></span><br><span class="line"><span class="comment">   * @param param 请求参数</span></span><br><span class="line"><span class="comment">   * @param ajaxType post\get,默认是post</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">var</span> serverAction = $rootScope.serverAction = <span class="function"><span class="keyword">function</span> (<span class="params">url, param, type</span>) </span>&#123;</span><br><span class="line">    param = param ? param : &#123;&#125;;</span><br><span class="line">    type = type || <span class="string">'GET'</span>;</span><br><span class="line">    param[<span class="string">'uid'</span>] = $rootScope.uid;</span><br><span class="line">    param[<span class="string">'token'</span>] = $rootScope.token;</span><br><span class="line">    <span class="keyword">if</span> (type == <span class="string">"GET"</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> param === <span class="string">'object'</span>) &#123;</span><br><span class="line">        url = url + <span class="string">"?"</span> + $.param(param);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> $http.get(url);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> _postCfg = &#123;</span><br><span class="line">        headers: &#123;</span><br><span class="line">          <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded; charset=UTF-8'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        transformRequest: <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> $.param(d, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> $http.post(url, param, _postCfg);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> api = &#123;</span><br><span class="line">    <span class="comment">//退出登录</span></span><br><span class="line">    _logup: <span class="function"><span class="keyword">function</span> (<span class="params">param, type</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> serverAction($rootScope.ctxPath + <span class="string">'/logout'</span>, param, type);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//用户登录</span></span><br><span class="line">    _loginQQ: <span class="function"><span class="keyword">function</span> (<span class="params">param, type</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> serverAction($rootScope.ctxPath + <span class="string">'/login'</span>, param, type);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//用户信息</span></span><br><span class="line">    _getUserInfo: <span class="function"><span class="keyword">function</span> (<span class="params">param, type</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> serverAction($rootScope.ctxPath + <span class="string">'/getUserInfoByUid'</span>, param, type);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'server'</span>)</span><br><span class="line">  <span class="keyword">return</span> api;</span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure>
<h3 id="github地址"><a href="#github地址" class="headerlink" title="github地址"></a>github地址</h3><p><a href="https://github.com/caitianxu/angular-ie8.git" target="_blank" rel="noopener">https://github.com/caitianxu/angular-ie8.git</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Henry.Cai" />
            
              <p class="site-author-name" itemprop="name">Henry.Cai</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Henry.Cai</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
